<?xml version="1.0" encoding="utf-8"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="6fe30b47-2577-43ad-9095-1861ca25889c" Name="MyProduct" Language="1033" Codepage="Windows-1252" Version="1.0.0.0" UpgradeCode="6fe30b47-2577-43ad-9095-1861ba25889b" Manufacturer="Vincent">
    <Package InstallerVersion="200" Compressed="yes" Platform="x64" SummaryCodepage="Windows-1252" Languages="1033" />
    <Media Id="1" Cabinet="MyProduct.cab" EmbedCab="yes" />

    <Condition Message="LANraragi for Windows can only be installed on a 64-bit Windows.">VersionNT64</Condition>
    <Condition Message="LANraragi for Windows can only be installed on Windows 10 and up."><![CDATA[VersionNT>="603"]]></Condition>
    <Condition Message="You must install the Windows Subsystem for Linux in order to use LANraragi for Windows. Check here: https://docs.microsoft.com/en-us/windows/wsl/install-win10">WSLInstalled="true"</Condition>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="AppDataFolder" Name="AppDataFolder">
        <Directory Id="INSTALLDIR" Name="LANraragi">

          <Component Id="Component.Emoji.Wpf.dll_229897616" Guid="6fe30b47-2577-43ad-9095-1861a341051c" Win64="yes">
            <File Id="Emoji.Wpf.dll_229897616" Source="..\Karen\bin\x64\Release\Emoji.Wpf.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Hardcodet.Wpf.TaskbarNotification.dll_1010392422" Guid="6fe30b47-2577-43ad-9095-1861179f98af" Win64="yes">
            <File Id="Hardcodet.Wpf.TaskbarNotification.dll_1010392422" Source="..\Karen\bin\x64\Release\Hardcodet.Wpf.TaskbarNotification.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Hardcodet.Wpf.TaskbarNotification.pdb_508113084" Guid="6fe30b47-2577-43ad-9095-18619a76a676" Win64="yes">
            <File Id="Hardcodet.Wpf.TaskbarNotification.pdb_508113084" Source="..\Karen\bin\x64\Release\Hardcodet.Wpf.TaskbarNotification.pdb" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.HideConsoleOnClose32.dll_1301435147" Guid="6fe30b47-2577-43ad-9095-1861614fc3ae" Win64="yes">
            <File Id="HideConsoleOnClose32.dll_1301435147" Source="..\Karen\bin\x64\Release\HideConsoleOnClose32.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.HideConsoleOnClose64.dll_1288720814" Guid="6fe30b47-2577-43ad-9095-1861dfd3d2f2" Win64="yes">
            <File Id="HideConsoleOnClose64.dll_1288720814" Source="..\Karen\bin\x64\Release\HideConsoleOnClose64.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.HideConsoleOnCloseManaged.dll_867210709" Guid="6fe30b47-2577-43ad-9095-1861664c631e" Win64="yes">
            <File Id="HideConsoleOnCloseManaged.dll_867210709" Source="..\Karen\bin\x64\Release\HideConsoleOnCloseManaged.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Karen_Installer.ps1_1407539582" Guid="6fe30b47-2577-43ad-9095-186117baca43" Win64="yes">
            <File Id="Karen_Installer.ps1_1407539582" Source="..\Karen\bin\x64\Release\Karen-Installer.ps1" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Karen_Uninstaller.ps1_1629319376" Guid="6fe30b47-2577-43ad-9095-1861337018d5" Win64="yes">
            <File Id="Karen_Uninstaller.ps1_1629319376" Source="..\Karen\bin\x64\Release\Karen-Uninstaller.ps1" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Karen.exe_1188372425" Guid="6fe30b47-2577-43ad-9095-186162c7b539" Win64="yes">
            <File Id="Karen.exe_1188372425" Source="..\Karen\bin\x64\Release\Karen.exe" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Karen.exe.config_2118951197" Guid="6fe30b47-2577-43ad-9095-18614da5756d" Win64="yes">
            <File Id="Karen.exe.config_2118951197" Source="..\Karen\bin\x64\Release\Karen.exe.config" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Karen.pdb_785350063" Guid="6fe30b47-2577-43ad-9095-18611c4ecbfa" Win64="yes">
            <File Id="Karen.pdb_785350063" Source="..\Karen\bin\x64\Release\Karen.pdb" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Typography.GlyphLayout.dll_994343102" Guid="6fe30b47-2577-43ad-9095-1861d3cd3ca9" Win64="yes">
            <File Id="Typography.GlyphLayout.dll_994343102" Source="..\Karen\bin\x64\Release\Typography.GlyphLayout.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Typography.OpenFont.dll_693950555" Guid="6fe30b47-2577-43ad-9095-18614ee0ab1d" Win64="yes">
            <File Id="Typography.OpenFont.dll_693950555" Source="..\Karen\bin\x64\Release\Typography.OpenFont.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Uninstall_My_Product" Guid="6fe30b47-2577-43ad-9095-1861838d17e2" Win64="yes">
            <Shortcut Id="INSTALLDIR.Uninstall_My_Product" WorkingDirectory="System64Folder" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" Name="Uninstall My Product.lnk" />

            <CreateFolder />
            <RemoveFolder Id="INSTALLDIR" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

        </Directory>
      </Directory>
    </Directory>

    <UI />

    <UI>
      <TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" Bold="no" Italic="no" Strike="no" Underline="no" />
      <TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="12" Bold="no" Italic="no" Strike="no" Underline="no" />
      <TextStyle Id="WixUI_Font_Title" FaceName="Tahoma" Size="9" Bold="yes" Italic="no" Strike="no" Underline="no" />

      <Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
      <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />
      <Property Id="PIDTemplate" Value="####-####-####-####" />
      <Property Id="ARPNOMODIFY" Value="1" />

      <DialogRef Id="BrowseDlg" />
      <DialogRef Id="DiskCostDlg" />
      <DialogRef Id="ErrorDlg" />
      <DialogRef Id="FatalError" />
      <DialogRef Id="FilesInUse" />
      <DialogRef Id="MsiRMFilesInUse" />
      <DialogRef Id="PrepareDlg" />
      <DialogRef Id="ProgressDlg" />
      <DialogRef Id="ResumeDlg" />
      <DialogRef Id="UserExit" />

      <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="LicenseAgreementDlg" Order="1">1</Publish>
      <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="InstallDirDlg" Order="5">1</Publish>
      <Publish Dialog="LicenseAgreementDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg">1</Publish>
      <Publish Dialog="LicenseAgreementDlg" Control="Next" Event="NewDialog" Value="InstallDirDlg">1</Publish>
      <Publish Dialog="InstallDirDlg" Control="Back" Event="NewDialog" Value="LicenseAgreementDlg" Order="1">1</Publish>
      <Publish Dialog="InstallDirDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg" Order="5">1</Publish>
      <Publish Dialog="InstallDirDlg" Control="Next" Event="SetTargetPath" Value="[WIXUI_INSTALLDIR]" Order="1">1</Publish>
      <Publish Dialog="InstallDirDlg" Control="Next" Event="DoAction" Value="ShowCustomDialog" Order="2">1</Publish>
      <Publish Dialog="InstallDirDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg" Order="3"> Custom_UI_Command = "next" </Publish>
      <Publish Dialog="InstallDirDlg" Control="Next" Event="EndDialog" Value="Exit" Order="2"> Custom_UI_Command = "abort" </Publish>
      <Publish Dialog="InstallDirDlg" Control="ChangeFolder" Value="[WIXUI_INSTALLDIR]" Property="_BrowseProperty" Order="1">1</Publish>
      <Publish Dialog="InstallDirDlg" Control="ChangeFolder" Event="SpawnDialog" Value="BrowseDlg" Order="2">1</Publish>
      <Publish Dialog="CustomizeDlg" Control="Back" Event="NewDialog" Value="InstallDirDlg">1</Publish>
      <Publish Dialog="CustomizeDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
      <Publish Dialog="MaintenanceWelcomeDlg" Control="Next" Event="NewDialog" Value="MaintenanceTypeDlg">1</Publish>
      <Publish Dialog="MaintenanceTypeDlg" Control="Back" Event="NewDialog" Value="MaintenanceWelcomeDlg">1</Publish>
      <Publish Dialog="MaintenanceTypeDlg" Control="RepairButton" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
      <Publish Dialog="MaintenanceTypeDlg" Control="RemoveButton" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
      <Publish Dialog="ExitDialog" Control="Finish" Event="EndDialog" Value="Return" Order="9999">1</Publish>
      <Publish Dialog="VerifyReadyDlg" Control="Back" Event="DoAction" Value="ShowCustomDialog" Order="1">1</Publish>
      <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="InstallDirDlg" Order="2"> Custom_UI_Command = "back" </Publish>
    </UI>

    <CustomAction Id="ShowCustomDialog" BinaryKey="ShowCustomDialog_File" DllEntry="ShowCustomDialog" Return="check" Execute="immediate" />

    <Binary Id="ShowCustomDialog_File" SourceFile="bin\%this%.CA.dll" />

    <UIRef Id="WixUI_Common" />
    <UIRef Id="WixUI_ErrorProgressText" />

    <Property Id="WSLInstalled" Value="false" />

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="Component.Emoji.Wpf.dll_229897616" />
      <ComponentRef Id="Component.Hardcodet.Wpf.TaskbarNotification.dll_1010392422" />
      <ComponentRef Id="Component.Hardcodet.Wpf.TaskbarNotification.pdb_508113084" />
      <ComponentRef Id="Component.HideConsoleOnClose32.dll_1301435147" />
      <ComponentRef Id="Component.HideConsoleOnClose64.dll_1288720814" />
      <ComponentRef Id="Component.HideConsoleOnCloseManaged.dll_867210709" />
      <ComponentRef Id="Component.Karen_Installer.ps1_1407539582" />
      <ComponentRef Id="Component.Karen_Uninstaller.ps1_1629319376" />
      <ComponentRef Id="Component.Karen.exe_1188372425" />
      <ComponentRef Id="Component.Karen.exe.config_2118951197" />
      <ComponentRef Id="Component.Karen.pdb_785350063" />
      <ComponentRef Id="Component.Typography.GlyphLayout.dll_994343102" />
      <ComponentRef Id="Component.Typography.OpenFont.dll_693950555" />
      <ComponentRef Id="Component.Uninstall_My_Product" />
    </Feature>

  </Product>
</Wix>

